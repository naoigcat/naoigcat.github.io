---
layout: post
title:  スプレッドシートのシートや範囲を保護する
date:   2023/03/20 12:20:28 +0900
tags:   google
---

## [シートや範囲を保護する](https://support.google.com/docs/answer/1218656?hl=ja)

1.  下記のいずれかを行って `保護されているシートと範囲` が右側に表示する

    -   シート名右側の下三角をクリックして表示されるメニューから `シートを保護` をクリックする
    -   範囲を選択して `データ` > `シートと範囲を保護` をクリックして `シート/範囲を追加` をクリックする

1.  保護したい対象を `範囲` と `シート` から選択する

1.  保護したい範囲・シートを指定して `権限を設定` をクリックする

    -   シートを指定するときは、 `特定のセルを除く` にチェックを入れることで保護しない範囲を指定することもできる

1.  `範囲の編集権限` で以下から選択する

    -   `この範囲を編集するときに警告を表示する`
    -   `この範囲を編集できるユーザーを制限する`

### この範囲を編集するときに警告を表示する

編集しようとすると

```txt
実行してもよろしいでしょうか？
シート上の保護された範囲を編集しようとしています。編集してもよろしいですか？
```

というメッセージが表示され、 `OK` をクリックすると実際に編集される。

-   `5分間このメッセージを表示しない` にチェックを入れることでメッセージを表示しないようにできる

-   範囲をコピーしてペーストしようとしたとき、ペーストする範囲に保護されている範囲が含まれている場合は同様にメッセージが表示される。

### この範囲を編集できるユーザーを制限する

権限が付与されていないユーザーが編集しようとすると

```txt
問題が発生しました
保護されているセルやオブジェクトを編集しようとしています。編集する必要がある場合は、スプレッドシートのオーナーに連絡して、保護を解除してもらってください。
```

というメッセージが表示され、編集できない。

-   自身がファイルのオーナーのときは `自分のみ` 、オーナーではないときは `自分とスプレッドシートのオーナーのみ` のどちらかと編集可能なユーザーを自由に追加できる `カスタム` が選択できる。

-   範囲をコピーしてペーストしようとしたとき、ペーストする範囲に保護されている範囲が含まれている場合はメッセージは表示されずにペーストが行われない。

## 数式の計算結果は権限に関係なく反映される

保護されている範囲に数式が入力されている場合や `ARRAYFORMULA` などの配列数式から返された値が入る場合はメッセージは表示されずに反映される。

## 保護されているシートや範囲のコピーを編集する

編集権限のない保護されているシートや範囲が含まれている場合でも、シートやスプレッドシートをコピーすると編集できるようになる。
