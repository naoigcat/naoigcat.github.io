---
layout: post
title:  スプレッドシートで条件付き書式を使用する
date:   2023/04/03 12:23:41 +0900
tags:   google
---

## セルに条件付き書式を適用する

1.  セルを選択する
1.  `表示形式` > `条件付き書式` をクリックする
1.  `条件付き書式設定ルール` パネルでルールを作成する
    -   `単一色`: `セルの書式設定の条件` でルールを適用する条件を選択して `書式設定のスタイル` で条件を満たしている場合の書式を選択する
    -   `カラースケール`: `プレビュー` でカラースケールを選択して `最小点`, `中央`, `最大点` を選択する
1.  完了をクリックする

-   複数の条件付き書式を追加することができてより上にある書式が優先される
    -   条件付き書式左側の `︙` をドラッグすることで優先順位を変更できる
    -   セル自体の書式は優先順位が最も下になる
-   条件付き書式で付けた色を `色でフィルタ` での絞り込みに使用できる
-   条件付き書式は書式なのでセルのコピー＆ペーストで上書きされる
    -   特に条件付き書式が未設定のセルをコピーして条件付き書式のあるセルにペーストするとそのセルだけ条件付き書式が削除される
    -   値のみ貼り付け（⌘⇧V / Ctrl+Shift+V）で条件付き書式を変更せずにペーストできる

## 単一色の条件を設定する

-   `セルの書式設定の条件` は `フィルタ` の `条件でフィルタ` と選択肢は同じ
-   カスタム数式で別のシートを参照するときは `'シート名'!A1` の形式でアクセスできず、 `INDIRECT` 関数を使用する必要がある

## カラースケールの条件を設定する

-   `最小点`, `中央`, `最大点` には `値`, `パーセント`, `パーセンタイル` と `最小点` には `最小値` 、 `最大点` には `最大値` が指定できる
    -   `パーセント` は `(値 - 最小値) / (最大値 - 最小値)` の計算結果
    -   `パーセンタイル` は小さい値から順番に並べたときの順位
