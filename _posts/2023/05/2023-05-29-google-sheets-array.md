---
layout: post
title:  スプレッドシートで配列を使用する
date:   2023/05/29 14:23:15 +0900
tags:   google
---

## 配列を使用する

配列とは、値を含む行と列からなるテーブルのことで、関数の中には配列を返すものがある。入力パラメータとして範囲を指定する関数では、代わりに配列を指定することもできる。

## 配列を作成する

数式内に`{}`の括弧を使用して配列を作成することもできる。この括弧で値をグループ化し、カンマとセミコロンで表示順序を指定する。

-   カンマ: 1行のデータを配列内に記述するために列を分割する。
-   セミコロン: 1列のデータを配列内に記述するために行を分割する。

### 例: 配列を作成する

-   `A1`セルに`={1,2}`と入力すると`A1`に`1`、`B1`に`2`が表示される。
-   `A1`セルに`={1;2}`と入力すると`A1`に`1`、`A2`に`2`が表示される。
-   `A1`セルに`={1,2;3,4}`と入力すると`A1`に`1`、`B1`に`2`、`A2`に`3`、`B2`に`4`が表示される。

## 配列を結合する

複数の範囲を単一の連続する範囲に結合できる。

### 例: 配列を結合する

-   `A1`セルに`={B1:B10;C1:C10}`と入力すると`A1:A20`に`B1:B10`と`C1:C10`の内容が表示される。

## 数式の戻り値を配列に格納する

括弧内に数式を記述することで数式の戻り値を配列に格納することができる。

### 例: 数式の戻り値を配列に格納する

-   `A1`セルに`={SUM(A2:A10), SUM(B2:B10)}`と入力すると`A1`に`A2:A10`の合計が、`B1`に`B2:B10`の合計が表示される。
-   `B1`セルに`={"DOUBLE";ARRAYFORMULA(A2:A10*2)}`と入力すると`B1`に`DOUBLE`、`B2:B10`に`A2:A10`を2倍した数値が表示される。
